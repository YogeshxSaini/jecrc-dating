exports.id=700,exports.ids=[700],exports.modules={2254:(e,t,a)=>{e.exports=a(4767)},6548:(e,t,a)=>{"use strict";a.d(t,{h:()=>o,x:()=>n});var i=a(1934),s=a(3257);class r{constructor(){this.requestQueue=[],this.client=i.default.create({baseURL:"https://jecrc-dating-backend.onrender.com",headers:{"Content-Type":"application/json"}}),this.client.interceptors.request.use(async e=>{if((0,s.L4)(),!await (0,s.x7)())return console.error("[API Client] Token validation failed after inactivity, redirecting to login"),console.log("[API Client] Redirecting to login - Reason: Token validation failed after inactivity"),window.location.href="/login",Promise.reject(Error("Token validation failed after inactivity"));if((0,s.dV)()&&!(0,s.N7)()){console.log("[API Client] Token needs refresh before request, refreshing proactively"),(0,s.yh)(!0);try{if(!await (0,s.Ls)())return console.error("[API Client] Proactive refresh failed, redirecting to login"),(0,s.yh)(!1),console.log("[API Client] Redirecting to login - Reason: Proactive token refresh failed"),window.location.href="/login",Promise.reject(Error("Token refresh failed"));console.log("[API Client] Proactive refresh successful")}finally{(0,s.yh)(!1)}}if((0,s.N7)()){console.log("[API Client] Refresh in progress, waiting...");let e=0;for(;(0,s.N7)()&&e<1e4;)await new Promise(e=>setTimeout(e,100)),e+=100;if(e>=1e4)return console.error("[API Client] Timeout waiting for refresh to complete"),Promise.reject(Error("Token refresh timeout"))}let t=this.getAccessToken();return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e)),this.client.interceptors.response.use(e=>e,async e=>{let t=e.config;if(e.response?.status===403){let t=e.response.data,a=t?.error||t?.message||"";if(a.toLowerCase().includes("banned")||a.toLowerCase().includes("deactivated")||a.toLowerCase().includes("suspended"))return console.log("[API Client] User banned/deactivated, clearing tokens and redirecting"),(0,s.yE)("User banned or deactivated"),Promise.reject(e)}if(e.response?.status===401&&!t._retry){if(t._retry=!0,!(0,s.dV)()){let e=this.getTokenExpiry();if(e){let t=new Date,a=e.getTime()-t.getTime();console.warn(`[API Client] Server/client time disagreement detected: Server returned 401 but client thinks token is valid for ${Math.floor(a/1e3/60)} more minutes. Trusting server response and refreshing token.`)}}if((0,s.N7)())return console.log("[API Client] Refresh in progress, queueing request"),this.queueRequest(t);(0,s.yh)(!0),console.log("[API Client] Starting token refresh due to 401");try{if(await (0,s.Ls)()){let e=this.getAccessToken();return console.log("[API Client] Token refresh successful, processing queue"),this.processQueue(null,e),e&&(t.headers.Authorization=`Bearer ${e}`),this.client(t)}return console.error("[API Client] Token refresh failed, clearing queue and redirecting"),this.processQueue(Error("Token refresh failed"),null),Promise.reject(Error("Token refresh failed"))}catch(e){return console.error("[API Client] Token refresh exception:",e),this.processQueue(e,null),Promise.reject(e)}finally{(0,s.yh)(!1)}}return Promise.reject(e)})}queueRequest(e){return new Promise((t,a)=>{this.requestQueue.push({config:e,resolve:t,reject:a})})}processQueue(e,t){console.log(`[API Client] Processing queue with ${this.requestQueue.length} requests`),this.requestQueue.forEach(a=>{e?a.reject(e):(t&&(a.config.headers=a.config.headers||{},a.config.headers.Authorization=`Bearer ${t}`),a.resolve(this.client(a.config)))}),this.requestQueue=[]}getAccessToken(){return null}getTokenExpiry(){return null}setAccessToken(e){}getRefreshToken(){return null}setRefreshToken(e){}clearTokens(){}async requestVerification(e,t=!1){return(await this.client.post("/api/auth/request-verification",{email:e,loginMode:t})).data}async verifyOTP(e,t,a,i){let r=await this.client.post("/api/auth/verify",{email:e,otp:t,password:a,displayName:i});return r.data.accessToken&&((0,s.km)(r.data.accessToken),this.setRefreshToken(r.data.refreshToken)),r.data}async login(e,t){let a=await this.client.post("/api/auth/login",{email:e,password:t});return a.data.accessToken&&((0,s.km)(a.data.accessToken),this.setRefreshToken(a.data.refreshToken)),a.data}async logout(){let e=this.getRefreshToken();await this.client.post("/api/auth/logout",{refreshToken:e}),(0,s.yE)("User logout")}async getMe(){return(await this.client.get("/api/auth/me")).data}async getMyProfile(){return(await this.client.get("/api/profile/me")).data}async updateProfile(e){return(await this.client.put("/api/profile",e)).data}async getProfile(e){return(await this.client.get(`/api/profile/${e}`)).data}async getDiscoverFeed(e=10,t=0){return(await this.client.get("/api/discover",{params:{limit:e,offset:t}})).data}async likeUser(e){return(await this.client.post("/api/likes",{toUserId:e})).data}async passUser(e){return(await this.client.post(`/api/discover/pass/${e}`)).data}async unlikeUser(e){return(await this.client.delete(`/api/likes/${e}`)).data}async getReceivedLikes(){return(await this.client.get("/api/likes/received")).data}async getMatches(){return(await this.client.get("/api/matches")).data}async getMatch(e){return(await this.client.get(`/api/matches/${e}`)).data}async getPhotoVerifications(e){return(await this.client.get("/api/admin/photo-verifications",{params:{status:e}})).data}async reviewPhotoVerification(e,t,a){return(await this.client.post(`/api/admin/photo-verifications/${e}/review`,{status:t,reason:a})).data}async getReports(e){return(await this.client.get("/api/admin/reports",{params:{status:e}})).data}async banUser(e,t){return(await this.client.post(`/api/admin/users/${e}/ban`,{reason:t})).data}async unbanUser(e){return(await this.client.post(`/api/admin/users/${e}/unban`)).data}async getAdminStats(){return(await this.client.get("/api/admin/stats")).data}async getAdminUsers(e=20,t=0,a){return(await this.client.get("/api/admin/users",{params:{limit:e,offset:t,search:a}})).data}async reviewReport(e,t,a){return(await this.client.post(`/api/admin/reports/${e}/review`,{status:t,resolution:a})).data}async getAnalytics(e=30){return(await this.client.get("/api/admin/analytics",{params:{days:e}})).data}async getUserActivity(e){return(await this.client.get(`/api/admin/users/${e}/activity`)).data}async bulkUserAction(e,t,a){return(await this.client.post("/api/admin/users/bulk-action",{action:e,userIds:t,reason:a})).data}async broadcastNotification(e,t,a,i){return(await this.client.post("/api/admin/broadcast",{title:e,message:t,type:a,userIds:i})).data}async getAdminChats(e=20,t=0){return(await this.client.get("/api/admin/chats",{params:{limit:e,offset:t}})).data}async getAuditLogs(e=50,t=0,a,i){return(await this.client.get("/api/admin/audit-logs",{params:{limit:e,offset:t,action:a,adminId:i}})).data}async getSystemSettings(){return(await this.client.get("/api/admin/settings")).data}async updateSystemSettings(e){return(await this.client.put("/api/admin/settings",e)).data}async getNotifications(){return(await this.client.get("/api/notifications")).data.notifications}async markNotificationAsRead(e){return(await this.client.put(`/api/notifications/${e}/read`)).data}async markAllNotificationsAsRead(){return(await this.client.put("/api/notifications/read-all")).data}async deleteLike(e){return(await this.client.delete(`/api/admin/likes/${e}`)).data}async deleteMatch(e){return(await this.client.delete(`/api/admin/matches/${e}`)).data}async getAllLikes(e,t,a){let i={limit:e,offset:t};return a&&(i.search=a),(await this.client.get("/api/admin/likes",{params:i})).data}async getAllMatches(e,t,a){let i={limit:e,offset:t};return a&&(i.search=a),(await this.client.get("/api/admin/matches",{params:i})).data}async uploadPhoto(e,t=!1){return(await this.client.post("/api/photos/upload",{imageData:e,isProfilePic:t})).data}async getPhotos(){return(await this.client.get("/api/photos")).data.photos}async updatePhoto(e,t){return(await this.client.put(`/api/photos/${e}`,t)).data}async deletePhoto(e){return(await this.client.delete(`/api/photos/${e}`)).data}}let n=new r,o=n}};