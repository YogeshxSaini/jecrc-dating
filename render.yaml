services:
  # Web Service (Backend API)
  - type: web
    name: jecrc-dating-backend
    env: docker
    plan: free
    repo: https://github.com/YogeshxSaini/jecrc-dating.git
    region: oregon
    dockerfilePath: ./backend/Dockerfile
    dockerContext: ./backend
    healthCheckPath: /health
    envVars:
      - key: NODE_ENV
        value: production
      - key: PORT
        value: 4000
      - key: DATABASE_URL
        fromDatabase:
          name: jecrc-dating-db
          property: connectionString
      - key: JWT_SECRET
        generateValue: true
      - key: JWT_REFRESH_SECRET  
        generateValue: true
      - key: ALLOWED_EMAIL_DOMAIN
        value: jecrcu.edu.in
      - key: EMAIL_PROVIDER
        value: console
      - key: EMAIL_FROM
        value: noreply@jecrcu.edu.in
      - key: FRONTEND_URL
        value: https://jecrc-dating.pages.dev
      # Note: Add REDIS_URL manually after setting up Upstash

databases:
  - name: jecrc-dating-db
    plan: free
    databaseName: jecrc_dating